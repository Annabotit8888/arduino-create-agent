<!DOCTYPE html>
<html>

<head>
    <title>Interactive docs for pkgs api</title>
</head>

<body>
    <p>pkgs api manage the indexes and tools installed on the system.</p>

    <h1>Indexes</h1>
    <p>An index file contains the info about a core and its tools. You can see an example at <a href="" target="_blank">https://downloads.arduino.cc/packages/package_index.json</a></p>

    <p>index files are saved (with an urlencoded filename) in the folder <code>~/.arduino-create/indexes</code></p>

    <h2>List Indexes</h2>
    <p>You can list the indexes installed in the system with this simple GET</p>
    <textarea cols="100" id="indexesList">
fetch('http://localhost:8991/v2/pkgs/indexes')
    </textarea><br>
    <textarea cols="100" rows="10" id="indexesListRes"></textarea><br>
    <button onclick="tryCode('indexesList', 'indexesListRes');">Try</button>

    <h2>Add Indexes</h2>
    <p>You can add a new index with a POST request</p>
    <textarea cols="100" rows="5" id="indexesCreate">
fetch('http://localhost:8991/v2/pkgs/indexes/add', {
    method: "POST",
    body: '{"url": "https://downloads.arduino.cc/packages/package_index.json"}'
})
    </textarea><br>
    <textarea cols="100" rows="10" id="indexesCreateRes">

    </textarea><br>
    <button onclick="tryCode('indexesCreate', 'indexesCreateRes');">Try</button>

</body>

<script>
function tryCode(code, target) {
    code = document.getElementById(code).textContent;
    target = document.getElementById(target);

    var result = eval(code);
    result.then(function (res) {
        target.innerHTML = res.statusText + "\n";
        return res.json();
    }).then(function (body) {
        target.innerHTML = target.innerHTML + JSON.stringify(body, " ", "  ");
        return;
    })
    .catch(function (err) {

        console.log(err)

        target.innerText = err;
    })

    console.debug(code, target, result)
}
</script>

</html>